# Explorando vunerabilidades de routers

Normalmente é mais fácil encontrar vunerabilidades em routers. Isso se deve ao fato que muitos utilizarem o login default de fábrica.

## [Github routersploit](https://github.com/threat9/routersploit)

O RouterSploit Framework é um framework de exploração de código aberto dedicado a mbedded devices.

É necessário ter o python3 instalado.
```
$ python3 --version
Python 3.13.5
```
### Instalando o exploit
```
$ git clone https://github.com/threat9/routersploit
Cloning into 'routersploit'...
remote: Enumerating objects: 8966, done.
remote: Counting objects: 100% (163/163), done.
remote: Compressing objects: 100% (100/100), done.
remote: Total 8966 (delta 118), reused 63 (delta 63), pack-reused 8803 (from 3)
Receiving objects: 100% (8966/8966), 1.94 MiB | 14.10 MiB/s, done.
Resolving deltas: 100% (6394/6394), done.
```
O git é colonado no diretório routersploit
`$ cd routersploit`
```
$ ls
CONTRIBUTING.md      docs      MANIFEST.in           requirements.txt  setup.py
docker-compose.yaml  LICENSE   README.md             routersploit      tests
Dockerfile           Makefile  requirements-dev.txt  rsf.py
```
Instalando os requerimentos:

- O router exploit não funciona com versões do python3 superior a 3.10. Portanto é necessário instalar alternativamente a versão 3.10.
- O Kali não permite instalar pacotes não oficiais do python. Desta forma, é necessário criar um ambiente virtual.

1. Instalando a versão alternativa 3.10
```
sudo apt install build-essential libssl-dev zlib1g-dev \
libncurses5-dev libncursesw5-dev libreadline-dev libsqlite3-dev \
libgdbm-dev libdb5.3-dev libbz2-dev libexpat1-dev liblzma-dev tk-dev

cd /usr/src
sudo wget https://www.python.org/ftp/python/3.10.13/Python-3.10.13.tgz
sudo tar xzf Python-3.10.13.tgz
cd Python-3.10.13
sudo ./configure --enable-optimizations
sudo make -j$(nproc)
sudo make altinstall
```
2. Criando um ambiente virtual dentro do projeto
`$ python3.10 -m venv meu_ambiente310`
2. Ativando o ambiente
```
$ source meu_ambiente310/bin/activate

┌──(White)(OpsShadow㉿Shadow)-[~/Documentos/White Hat/routersploit]
```
3. Instalando as dependências do projeto
```
$ pip install -r requirements.txt
Collecting requests==2.32.2 (from -r requirements.txt (line 1))
  Downloading requests-2.32.2-py3-none-any.whl.metadata (4.6 kB)
Collecting paramiko (from -r requirements.txt (line 2))
  Downloading paramiko-4.0.0-py3-none-any.whl.metadata (3.9 kB)
...
Successfully installed bcrypt-4.3.0 certifi-2025.8.3 cffi-1.17.1 charset-normalizer-3.4.3 cryptography-45.0.6 idna-3.10 invoke-2.2.0 paramiko-4.0.0 pyasn1-0.6.1 pycparser-2.22 pycryptodome-3.23.0 pynacl-1.5.0 pysnmp-7.1.21 requests-2.32.2 urllib3-2.5.0
```
### Descobrindo o router
```
$ netstat -nr                                                                                   
Tabela de Roteamento IP do Kernel
Destino         Roteador        MáscaraGen.    Opções   MSS Janela  irtt Iface
0.0.0.0         192.168.1.254   0.0.0.0         UG        0 0          0 wlan0
172.17.0.0      0.0.0.0         255.255.0.0     U         0 0          0 docker0
192.168.1.0     0.0.0.0         255.255.255.0   U         0 0          0 wlan0
```
IP do router: **192.168.1.254**

### Executando o routersploit
```
$ python rsf.py
 ______            _            _____       _       _ _
 | ___ \          | |          /  ___|     | |     (_) |
 | |_/ /___  _   _| |_ ___ _ __\ `--. _ __ | | ___  _| |_
 |    // _ \| | | | __/ _ \ '__|`--. \ '_ \| |/ _ \| | __|
 | |\ \ (_) | |_| | ||  __/ |  /\__/ / |_) | | (_) | | |_
 \_| \_\___/ \__,_|\__\___|_|  \____/| .__/|_|\___/|_|\__|
                                     | |
       Exploitation Framework for    |_|    by Threat9
            Embedded Devices

 Codename   : I Knew You Were Trouble
 Version    : 3.4.7
 Homepage   : https://www.threat9.com - @threatnine

 Exploits: 143 Scanners: 4 Creds: 171 Generic: 4 Payloads: 32 Encoders: 6

rsf > 
```
```
rsf > search scanners
scanners/autopwn
scanners/routers/router_scan
scanners/misc/misc_scan
scanners/cameras/camera_scan
```
Selecionando o scanner

`rsf > use scanners/autopwn`

Verificando as opções do scanner
```
rsf (AutoPwn) > show options

Target options:

   Name       Current settings     Description                     
   ----       ----------------     -----------                     
   target                          Target IPv4 or IPv6 address     


Module options:

   Name           Current settings     Description                           
   ----           ----------------     -----------                           
   vendor         any                  Vendor concerned (default: any)       
   http_use       true                 Check HTTP[s] service: true/false     
   http_ssl       false                HTTPS enabled: true/false             
   ftp_use        true                 Check FTP[s] service: true/false      
   ftp_ssl        false                FTPS enabled: true/false              
   ssh_use        true                 Check SSH service: true/false         
   telnet_use     true                 Check Telnet service: true/false      
   snmp_use       true                 Check SNMP service: true/false        
   threads        8                    Number of threads    
```
Precisa configurar o alvo
```
rsf (AutoPwn) > set target 192.168.1.254
[+] target => 192.168.1.254
```
### Resultado
```
rsf (AutoPwn) > run
[*] Running module scanners/autopwn...

[*] 192.168.1.254 Starting vulnerablity check...
[-] 192.168.1.254:80 http exploits/generic/heartbleed is not vulnerable
[-] 192.168.1.254:80 http exploits/routers/comtrend/ct_5361t_password_disclosure is not vulnerable
...
[*] 192.168.1.254 Could not verify exploitability:
 - 192.168.1.254:80 http exploits/routers/asus/asuswrt_lan_rce
 - 192.168.1.254:23 custom/tcp exploits/routers/cisco/catalyst_2960_rocem
 - 192.168.1.254:80 http exploits/routers/cisco/secure_acs_bypass
 - 192.168.1.254:80 http exploits/routers/netgear/dgn2200_dnslookup_cgi_rce
 - 192.168.1.254:80 http exploits/routers/shuttle/915wm_dns_change
 - 192.168.1.254:80 http exploits/routers/3com/officeconnect_rce
 - 192.168.1.254:80 http exploits/routers/billion/billion_5200w_rce
 - 192.168.1.254:80 http exploits/routers/dlink/dsl_2740r_dns_change
 - 192.168.1.254:80 http exploits/routers/dlink/dsl_2730b_2780b_526b_dns_change
 - 192.168.1.254:1900 custom/udp exploits/routers/dlink/dir_815_850l_rce
 - 192.168.1.254:80 http exploits/routers/dlink/dsl_2640b_dns_change

[-] 192.168.1.254 Could not confirm any vulnerablity

[-] 192.168.1.254 Could not find default credentials
```
Aparentemente nõ existe vunerabilidade
- [-] Não há vunerabilidade
- [*] Não foi capaz de determinar 
- [+] Há vunerabilidade

### Desativando a sessão
`rsf (AutoPwn) > exit`

`$ deactivate`
