# Hydra

Ferramenta de **for√ßa bruta/ataque de dicion√°rio online** usada em **pentests** para testar credenciais fracas em **servi√ßos de rede**. Diferente de ‚Äúcrackers‚Äù offline (ex.: hashcat), o Hydra testa **diretamente no servi√ßo** (SSH, FTP, HTTP, etc.) usando tentativas de login reais.

## Como funciona

* **Conecta** em um servi√ßo/protocolo e tenta combina√ß√µes de **usu√°rio** e **senha** vindas de **wordlists** ou regras simples de gera√ß√£o.
* Faz isso de forma **massivamente paralela** (v√°rias threads), o que acelera o teste.
* **M√≥dulos** por protocolo implementam o fluxo de autentica√ß√£o de cada servi√ßo.

## Protocolos (exemplos comuns)

SSH, FTP, Telnet, RDP, SMB, VNC, SNMP, SMTP/POP3/IMAP (mail), HTTP/HTTPS (b√°sico, form-based, auth), LDAP, MySQL/PostgreSQL/Redis/Mongo, entre outros.

## Recursos-chave

* **Paralelismo** configur√°vel (r√°pido, mas sujeito a travas/lockouts).
* Suporte a **SSL/TLS** e **IPv6**.
* **Proxies** e roteamento (inclui SOCKS/HTTP).
* **Entrada flex√≠vel**: listas separadas de usu√°rios (`-L`) e senhas (`-P`) ou pares (`-C`); tentativa de **senha vazia / igual ao usu√°rio** (`-e ns`); **gera√ß√£o simples** de senhas (`-x`).
* **Alvos m√∫ltiplos** (`-M`) e **sa√≠da** para arquivo (`-o`).
* Interface **gr√°fica** opcional (**xhydra**) e assistente interativo (**hydra-wizard**).

## Exemplos (ilustrativos)

> Use **apenas** em ambientes sob sua autoriza√ß√£o.

```bash
# SSH com listas de usu√°rios e senhas
hydra -L users.txt -P senhas.txt ssh://192.168.1.10 -t 4 -V

# HTTP form-based (indicando campos de login/senha e resposta que indica falha)
hydra -l admin -P senhas.txt 192.168.1.20 http-post-form "/login:username=^USER^&password=^PASS^:Invalid login" -t 6

# RDP
hydra -L users.txt -P senhas.txt rdp://alvo.local -t 3
```

## Limita√ß√µes e cuidados

* **Ru√≠do/Detec√ß√£o**: gera muitos requests; **WAF/IDS** e **lockout** de conta podem disparar.
* **Lentid√£o inerente**: por ser **online**, √© mais lento que quebrar **hashes offline**.

## Quando usar (e quando n√£o)

* **Use** para validar **higiene de senhas** em servi√ßos expostos (externos/internos) ou rotas de SSO.
* **Prefira offline** (hashcat/John) quando voc√™ j√° tem **hashes** de senhas.
* Para ambientes cr√≠ticos, combine com **pol√≠ticas de senha**, **MFA**, **rate limiting**, **bloqueio progressivo** e **monitoramento**.

# Hydra cheat sheet

## Sintaxe b√°sica

```
hydra [OP√á√ïES] PROTOLO://ALVO[:PORTA]
```

Ex.: `hydra -L users.txt -P senhas.txt ssh://192.168.1.10 -t 4 -V`

## Alvo(s)

* **`ALVO` √∫nico**: `ssh://10.0.0.5`
* **`-M <arquivo>`**: lista de alvos (um por linha).
* **`-s <porta>`**: porta customizada (se n√£o usar no esquema).
* **`-S`**: for√ßa SSL/TLS (quando o m√≥dulo suporta).
* **`-6`**: IPv6.

## Credenciais (o cora√ß√£o do Hydra)

* **`-l <user>`**: um usu√°rio fixo.
* **`-L <arquivo>`**: lista de usu√°rios.
* **`-p <senha>`**: uma senha fixa.
* **`-P <arquivo>`**: lista de senhas.
* **`-C <arquivo>`**: pares `usuario:senha` (um por linha).
* **`-e nsr`**: tenta **n** (senha vazia), **s** (senha = usu√°rio), **r** (senha = usu√°rio invertido).
* **`-x <min>:<max>:<charset>`**: gera senhas on-the-fly.

  * Exemplos de *charset*: `1` (d√≠gitos), `a` (min√∫sculas), `A` (mai√∫sculas), `!` (s√≠mbolos).
  * Ex.: `-x 6:8:aA1` ‚Üí senhas de 6‚Äì8 com letras (a/A) e n√∫meros.

## Paralelismo, ordem e desempenho

* **`-t <N>`**: n√∫mero de threads por alvo (tipicamente 4‚Äì16).
* **`-u`**: **password spraying** (tenta 1 senha para **todos** os usu√°rios antes da pr√≥xima).
* **`-w <seg>`**: *timeout* (segundos) por tentativa (√∫til em links lentos).
* **`-q`**: silencioso (menos logs).
* **`-v` / `-V`**: verboso / **mostra cada tentativa**.
* **`-d`**: debug.

## Parar quando achar (economiza tempo/ru√≠do)

* **`-f`**: para **ap√≥s encontrar 1 credencial v√°lida para aquele host**.
* **`-F`**: para **ap√≥s a primeira credencial v√°lida em qualquer host** (global).

## Entrada/sa√≠da e repetibilidade

* **`-o <arquivo>`**: grava resultados em arquivo.
* **`-R`**: retoma sess√£o anterior (restore).
* **`--continue`** (algumas vers√µes): continua mesmo se encontrar hits cedo (consulte `hydra -h`).

## M√≥dulos de protocolo (dicas r√°pidas)

* **SSH**: `ssh://host`
* **FTP**: `ftp://host`
* **RDP**: `rdp://host`
* **SMB**: `smb://host`
* **MySQL/Postgres**: `mysql://host`, `postgres://host`
* **HTTP(s)**:

  * **Basic/Digest/NTLM**: `http[s]-head`/`http[s]-get`/`http[s]-post` conforme o m√≥dulo.
  * **Form-based**: `http[s]-get-form` ou `http[s]-post-form`.

üëâ **Dica de ouro**: use **`-U <m√≥dulo>`** para ver a **ajuda espec√≠fica** do m√≥dulo.
Ex.: `hydra -U http-post-form`

## HTTP form-based (padr√£o do dia a dia)

Formato (m√≥dulos `http[s]-post-form` / `http[s]-get-form`):

```
"/caminho:campoUsuario=^USER^&campoSenha=^PASS^:string_que_indica_falha"
```

Exemplos:

```bash
# POST de login com string de falha "Invalid login"
hydra -l admin -P senhas.txt 192.168.1.20 \
  http-post-form "/login:username=^USER^&password=^PASS^:Invalid login" -t 6 -V

# GET form (mais raro), checando "Erro" na resposta
hydra -L users.txt -P wordlist.txt alvo.local \
  http-get-form "/auth?u=^USER^&p=^PASS^:Erro" -t 8 -f
```

Outras dicas HTTP:

* Se a **string de sucesso** for mais confi√°vel, troque a terceira parte por ela com `S=` (ver `-U http-post-form`).
* Para **redirecionamento** ap√≥s sucesso, √†s vezes vale usar um **regex** na terceira parte.

## Exemplos r√°pidos por protocolo

```bash
# SSH (threads 4, mostra cada tentativa)
hydra -L users.txt -P senhas.txt ssh://10.0.0.5 -t 4 -V

# RDP
hydra -L users.txt -P senhas.txt rdp://alvo.local -t 3 -f

# SMB
hydra -L users.txt -P senhas.txt smb://192.168.1.50 -t 6

# MySQL
hydra -L users.txt -P senhas.txt mysql://db.interno -t 6 -f

# M√∫ltiplos alvos (arquivo com hosts)
hydra -L users.txt -P senhas.txt -M hosts.txt ssh -t 6 -F
```

## Estrat√©gia pr√°tica

* **Spray** primeiro (`-u`) com um pequeno set de senhas ‚Äúcorporativas‚Äù comuns.
* Depois, **aprofundar** com wordlists maiores (rockyou, custom corporativa) e `-t` mais alto ‚Äî respeitando lockout/rate-limit.
* Para HTTPs complexos (token/headers), prefira **Burp** para entender o fluxo e ajustar o **formato do m√≥dulo**.

### Etiqueta/seguran√ßa operacional

* Combine **limites** (tentativas/minuto), **janelas** e hor√°rios com o cliente.
* Monitore **lockouts** e **WAF/IDS**.
* Registre **fonte, escopo e autoriza√ß√£o**; salve `-o` como evid√™ncia.

Se quiser, monto uma **planilha de execu√ß√£o** (alvos, m√≥dulos, flags, wordlists, limites e resultados) ou um **script shell** que roda lotes de testes com `-M`, organiza sa√≠das e faz **resume** autom√°tico com `-R`.

# Wordlists

- **SecLists**: Um dos reposit√≥rios mais completos e respeitados. Ele inclui listas de usu√°rios, senhas, URLs, payloads e muito mais.
  - GitHub: [https://github.com/danielmiessler/SecLists](https://github.com/danielmiessler/SecLists)

- **Kali Linux**: Se voc√™ estiver usando Kali, ele j√° vem com v√°rias wordlists pr√©-instaladas, como:
  - `/usr/share/wordlists/rockyou.txt` ‚Äî uma lista famosa de senhas reais vazadas (descompacte com `gunzip` se necess√°rio).

- **Weakpass**: Um projeto que re√∫ne senhas fracas e comuns usadas em ataques de for√ßa bruta.
  - Site: [https://weakpass.com/](https://weakpass.com/)
